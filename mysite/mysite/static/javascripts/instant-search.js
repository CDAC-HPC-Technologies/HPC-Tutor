var SearchView=function(){var search;this.trigger=function(q){search.helper.setQuery(q).search()};this.helper=function(){return search.helper};this.init=function(index){if(index===undefined||index===""){index="scenarios"}search=instantsearch({appId:"TVWK52XP4G",apiKey:"cdfdcc50253daeff45cb0660132cd85f",indexName:index,customRanking:["desc(is_trusted_user)","desc(boosted)","desc(rating)"],urlSync:true,searchFunction:function(helper){var searchResults=$(".search-results");var mainContent=$(".main-content");if(helper.state.query===""){mainContent.show();searchResults.hide();return}helper.search();searchResults.show();mainContent.hide()}});search.addWidget(instantsearch.widgets.searchBox({container:"#search-input",autofocus:false}));var item_template="<div class='panel col s3 offset-s1 offset-m0'> "+"<span class='{{scenariosClass}}'> {{countText}} </span> "+"<h4>{{title}}</h4> "+"<p> {{description}} </p> "+"<a class='action start' href='{{link}}'> "+"{{startHTML}} "+"</a> </div> ";search.addWidget(instantsearch.widgets.hits({container:"#hits",hitsPerPage:12,templates:{item:item_template,empty:'We didn\'t find any results for the search <em>"{{query}}"</em>'},transformData:function(hit){hit.scenariosClass=hit.scenarios||hit.author?"count":"hidden";hit.countText=hit.scenarios?hit.scenarios+" SCENARIOS":"By "+hit.author;hit.startHTML=hit.is_course?"Start Course":"Start Scenario";return hit}}));search.addWidget(instantsearch.widgets.pagination({container:".pagination",showFirstLast:false,scrollTo:"#search-input",cssClasses:{root:"search-root",item:"search-item",active:"search-active"}}));search.addWidget(instantsearch.widgets.analytics({pushFunction:function(formattedParameters,state,results){mixpanel.track("search",{_Search:state.query,_NumberOfHits:results.nbHits});window.ga("set","page","/search?query="+state.query+"&"+formattedParameters+"&numberOfHits="+results.nbHits);window.ga("send","pageView")}}));search.start()}};